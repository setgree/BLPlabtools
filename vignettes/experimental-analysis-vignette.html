<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Experimental analysis and table formatting</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Experimental analysis and table
formatting</h1>



<div id="introduction" class="section level2">
<h2>1 Introduction</h2>
<p>This vignette demonstrates tools for analyzing experimental data and
creating publication-ready tables. While the previous vignettes focused
on meta-analysis, this one covers the experimental analysis workflow
using functions designed to streamline common tasks in social psychology
research.</p>
<p>When you analyze experimental data, you often need to:</p>
<ul>
<li>Run many regression specifications (different dependent variables,
different sets of controls, different subsamples)</li>
<li>Account for clustering in your standard errors (students within
schools, voters within precincts)</li>
<li>Create publication-ready tables with proper formatting</li>
</ul>
<p>PaluckTools provides three main categories of functions to help with
these tasks:</p>
<ol style="list-style-type: decimal">
<li><strong><code>tidy_lm</code></strong> for running multiple
regression specifications efficiently</li>
<li><strong><code>robust_se</code></strong> for cluster-robust standard
errors</li>
<li><strong>Table formatting utilities</strong> for creating
publication-ready LaTeX tables</li>
</ol>
<p>This vignette walks through each of these tools using realistic
simulated data from a growth mindset intervention study.</p>
</div>
<div id="example-data-growth-mindset-intervention" class="section level2">
<h2>2 Example data: Growth mindset intervention</h2>
<p>For realistic examples, we’ll create a simulated dataset from a
typical social psychology experiment. Imagine a study testing whether a
growth mindset intervention improves student outcomes across 20 schools
(100 students per school).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(BLPlabtools)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;dplyr&#39;</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co"># Simulate experimental data</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>n_schools <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>n_per_school <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> n_schools <span class="sc">*</span> n_per_school</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>experiment_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  <span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span>n_total,</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  <span class="at">school_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_schools, <span class="at">each =</span> n_per_school),</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  <span class="co"># Treatment assignment (randomized within schools)</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n_per_school<span class="sc">/</span><span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">1</span>, n_per_school<span class="sc">/</span><span class="dv">2</span>)), n_schools),</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>  <span class="co"># Baseline covariates</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>  <span class="at">baseline_score =</span> <span class="fu">rnorm</span>(n_total, <span class="at">mean =</span> <span class="dv">70</span>, <span class="at">sd =</span> <span class="dv">15</span>),</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>  <span class="at">gender =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>), n_total, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>  <span class="co"># Outcomes (treatment effect = +5 points on average)</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>  <span class="at">test_score =</span> <span class="dv">70</span> <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n_per_school<span class="sc">/</span><span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">1</span>, n_per_school<span class="sc">/</span><span class="dv">2</span>)), n_schools) <span class="sc">+</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>               <span class="fu">rnorm</span>(n_total, <span class="at">sd =</span> <span class="dv">12</span>),</span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>  <span class="at">attendance =</span> <span class="fl">0.85</span> <span class="sc">+</span> <span class="fl">0.03</span><span class="sc">*</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n_per_school<span class="sc">/</span><span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">1</span>, n_per_school<span class="sc">/</span><span class="dv">2</span>)), n_schools) <span class="sc">+</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>               <span class="fu">rnorm</span>(n_total, <span class="at">sd =</span> <span class="fl">0.1</span>),</span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a>  <span class="at">attitudes =</span> <span class="fl">3.5</span> <span class="sc">+</span> <span class="fl">0.3</span><span class="sc">*</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n_per_school<span class="sc">/</span><span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">1</span>, n_per_school<span class="sc">/</span><span class="dv">2</span>)), n_schools) <span class="sc">+</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>              <span class="fu">rnorm</span>(n_total, <span class="at">sd =</span> <span class="fl">0.8</span>)</span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">factor</span>(treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Treatment&quot;</span>)),</span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">factor</span>(gender)</span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a>  )</span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a><span class="co"># Preview the data structure</span></span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a><span class="fu">head</span>(experiment_data)</span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a><span class="co">#&gt;   student_id school_id treatment baseline_score gender test_score attendance</span></span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a><span class="co">#&gt; 1          1         1   Control       61.59287   male   68.19631  0.8005826</span></span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a><span class="co">#&gt; 2          2         1   Control       66.54734   male   66.06691  0.9627593</span></span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a><span class="co">#&gt; 3          3         1   Control       93.38062   male   52.62202  0.7353050</span></span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a><span class="co">#&gt; 4          4         1   Control       71.05763 female   61.63258  0.9981019</span></span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a><span class="co">#&gt; 5          5         1   Control       71.93932 female  101.18188  0.9416191</span></span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a><span class="co">#&gt; 6          6         1   Control       95.72597 female   69.55102  0.8835131</span></span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a><span class="co">#&gt;   attitudes</span></span>
<span id="cb1-50"><a href="#cb1-50" tabindex="-1"></a><span class="co">#&gt; 1  2.205571</span></span>
<span id="cb1-51"><a href="#cb1-51" tabindex="-1"></a><span class="co">#&gt; 2  3.803345</span></span>
<span id="cb1-52"><a href="#cb1-52" tabindex="-1"></a><span class="co">#&gt; 3  5.021800</span></span>
<span id="cb1-53"><a href="#cb1-53" tabindex="-1"></a><span class="co">#&gt; 4  3.981499</span></span>
<span id="cb1-54"><a href="#cb1-54" tabindex="-1"></a><span class="co">#&gt; 5  4.885880</span></span>
<span id="cb1-55"><a href="#cb1-55" tabindex="-1"></a><span class="co">#&gt; 6  3.382504</span></span></code></pre></div>
<p>This dataset has: - <strong>2,000 students</strong> across <strong>20
schools</strong> (clustered data) - <strong>Treatment variable</strong>:
Growth mindset intervention (Control vs Treatment) - <strong>Baseline
covariate</strong>: prior test scores, gender -
<strong>Outcomes</strong>: test scores, attendance rate, attitude scale
(1-5)</p>
<div id="what-your-experimental-data-should-look-like" class="section level3">
<h3>What your experimental data should look like</h3>
<p>For experimental analysis with <code>tidy_lm</code> and
<code>robust_se</code>, your data should be in “long” format with one
row per observation (student, participant, unit). Here’s what you
need:</p>
<p><strong>Essential columns:</strong></p>
<ul>
<li><strong>ID variables</strong>: Unique identifier for each
observation (e.g., <code>student_id</code>)</li>
<li><strong>Clustering variable</strong>: If data are clustered (e.g.,
<code>school_id</code>, <code>site_id</code>, <code>pair_id</code>)</li>
<li><strong>Treatment variable</strong>: Binary or factor variable
indicating treatment assignment (e.g., <code>treatment</code>)</li>
<li><strong>Outcome variables</strong>: Numeric variables you want to
analyze (e.g., <code>test_score</code>, <code>attendance</code>,
<code>attitudes</code>)</li>
</ul>
<p><strong>Recommended columns:</strong></p>
<ul>
<li><strong>Baseline covariates</strong>: Pre-treatment variables for
precision (e.g., <code>baseline_score</code>, <code>gender</code>,
<code>age</code>)</li>
<li><strong>Moderators</strong>: Variables for subgroup analysis (e.g.,
<code>gender</code>, <code>school_type</code>)</li>
</ul>
<p>The <code>tidy_lm</code> function is designed to work with
<strong>tidy data</strong> where: - Each row is an observation - Each
column is a variable - Each cell contains a single value</p>
<p>This is the standard format for data analysis in R. If your data are
in wide format (e.g., separate columns for pretest and posttest), you’ll
need to reshape them using <code>tidyr::pivot_longer()</code> or similar
tools.</p>
<p><strong>A note on clustering</strong>: If your experimental units are
nested (students within schools, voters within precincts), you should
account for this by specifying the <code>clusters</code> parameter in
<code>tidy_lm</code> or using <code>robust_se</code> directly. This
adjusts standard errors to account for within-cluster correlation and
prevents false precision in your estimates.</p>
</div>
</div>
<div id="running-multiple-regressions-with-tidy_lm" class="section level2">
<h2>3 Running multiple regressions with <code>tidy_lm</code></h2>
<p>When analyzing experimental data, you often need to run many
regression specifications: different dependent variables, different sets
of controls, different subsamples. The <code>tidy_lm</code> function
streamlines this process by allowing you to specify multiple models at
once and returning the results in a tidy data frame format.</p>
<div id="basic-usage" class="section level3">
<h3>3.1 Basic usage</h3>
<p>Test whether the treatment affects test scores:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Simple treatment effect</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">tidy_lm</span>(</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">data =</span> experiment_data,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">&quot;test_score&quot;</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">terms =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="st">&quot;treatment&quot;</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co"># View treatment coefficient</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>results <span class="sc">|&gt;</span> <span class="fu">select</span>(dv, treatmentTreatment_coef, treatmentTreatment_p)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;   dv         treatmentTreatment_coef treatmentTreatment_p</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                        &lt;dbl&gt;                &lt;dbl&gt;</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; 1 test_score                    4.72             2.18e-18</span></span></code></pre></div>
<p>The output is a tidy data frame where each row represents one
regression model. The <code>treatment</code> parameter extracts
coefficients automatically.</p>
</div>
<div id="multiple-dependent-variables" class="section level3">
<h3>3.2 Multiple dependent variables</h3>
<p>Test treatment effects across all outcomes simultaneously:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Test treatment on test scores, attendance, and attitudes</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>multi_outcome <span class="ot">&lt;-</span> <span class="fu">tidy_lm</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">data =</span> experiment_data,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">dv =</span> <span class="fu">c</span>(<span class="st">&quot;test_score&quot;</span>, <span class="st">&quot;attendance&quot;</span>, <span class="st">&quot;attitudes&quot;</span>),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">terms =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="st">&quot;treatment&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># View treatment effects across all outcomes</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>multi_outcome <span class="sc">|&gt;</span> <span class="fu">select</span>(dv, treatmentTreatment_coef, treatmentTreatment_p)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt;   dv         treatmentTreatment_coef treatmentTreatment_p</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                        &lt;dbl&gt;                &lt;dbl&gt;</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; 1 test_score                  4.72               2.18e-18</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; 2 attendance                  0.0382             1.41e-17</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; 3 attitudes                   0.302              3.03e-16</span></span></code></pre></div>
</div>
<div id="different-regression-styles" class="section level3">
<h3>3.3 Different regression styles</h3>
<p>Control for baseline covariates in different ways:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># &quot;bivariate&quot;: treatment only</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>bivariate <span class="ot">&lt;-</span> <span class="fu">tidy_lm</span>(</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">data =</span> experiment_data,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">&quot;test_score&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">terms =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">style =</span> <span class="st">&quot;bivariate&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co"># &quot;incremental&quot;: progressively add controls</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>incremental <span class="ot">&lt;-</span> <span class="fu">tidy_lm</span>(</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="at">data =</span> experiment_data,</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">&quot;test_score&quot;</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;baseline_score&quot;</span>, <span class="st">&quot;gender&quot;</span>),</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="at">style =</span> <span class="st">&quot;incremental&quot;</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>)</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co"># &quot;default&quot;: all terms together</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">tidy_lm</span>(</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  <span class="at">data =</span> experiment_data,</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">&quot;test_score&quot;</span>,</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;baseline_score&quot;</span>, <span class="st">&quot;gender&quot;</span>),</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>  <span class="at">style =</span> <span class="st">&quot;default&quot;</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>)</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bivariate:&quot;</span>, <span class="fu">nrow</span>(bivariate), <span class="st">&quot;model</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; Bivariate: 1 model</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Incremental:&quot;</span>, <span class="fu">nrow</span>(incremental), <span class="st">&quot;models (adds controls one at a time)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt; Incremental: 3 models (adds controls one at a time)</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Default:&quot;</span>, <span class="fu">nrow</span>(full_model), <span class="st">&quot;model (all controls together)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt; Default: 1 model (all controls together)</span></span></code></pre></div>
</div>
<div id="real-world-workflow-multiple-outcomes-with-controls" class="section level3">
<h3>3.4 Real-world workflow: Multiple outcomes with controls</h3>
<p>A typical analysis tests treatment effects on multiple outcomes, with
and without controls:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Analyze all outcomes with progressive controls</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>full_analysis <span class="ot">&lt;-</span> <span class="fu">tidy_lm</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">data =</span> experiment_data,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">dv =</span> <span class="fu">c</span>(<span class="st">&quot;test_score&quot;</span>, <span class="st">&quot;attendance&quot;</span>, <span class="st">&quot;attitudes&quot;</span>),</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;baseline_score&quot;</span>, <span class="st">&quot;gender&quot;</span>),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">style =</span> <span class="st">&quot;incremental&quot;</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co"># Extract treatment effects across all specifications</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>full_analysis <span class="sc">|&gt;</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  <span class="fu">select</span>(model_number, dv, treatmentTreatment_coef,</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>         treatmentTreatment_se, treatmentTreatment_p) <span class="sc">|&gt;</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">significant =</span> treatmentTreatment_p <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 × 6</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt;   model_number dv         treatmentTreatment_coef treatmentTreatment_se</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt;          &lt;int&gt; &lt;chr&gt;                        &lt;dbl&gt;                 &lt;dbl&gt;</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; 1            1 test_score                  4.72                 0.535  </span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; 2            2 test_score                  4.70                 0.535  </span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; 3            3 test_score                  4.67                 0.534  </span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; 4            4 attendance                  0.0382               0.00444</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; 5            5 attendance                  0.0382               0.00444</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; 6            6 attendance                  0.0382               0.00444</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; 7            7 attitudes                   0.302                0.0366 </span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt; 8            8 attitudes                   0.302                0.0366 </span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt; 9            9 attitudes                   0.299                0.0365 </span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co">#&gt; # ℹ 2 more variables: treatmentTreatment_p &lt;dbl&gt;, significant &lt;lgl&gt;</span></span></code></pre></div>
</div>
</div>
<div id="cluster-robust-standard-errors" class="section level2">
<h2>4 Cluster-robust standard errors</h2>
<p>Our students are clustered within schools, so we need cluster-robust
standard errors to account for within-school correlation. Why does this
matter? When observations are clustered (students within schools, voters
within precincts), the usual assumption that observations are
independent is violated. Students in the same school might be more
similar to each other than to students in other schools, which means the
standard errors from ordinary regression will be too small, leading to
overconfident conclusions.</p>
<div id="using-robust_se" class="section level3">
<h3>4.1 Using <code>robust_se</code></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Basic regression (ignores clustering)</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(test_score <span class="sc">~</span> treatment <span class="sc">+</span> baseline_score, <span class="at">data =</span> experiment_data)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># Get cluster-robust SEs (clustering by school)</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>robust_results <span class="ot">&lt;-</span> <span class="fu">robust_se</span>(model, <span class="at">cluster =</span> experiment_data<span class="sc">$</span>school_id)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># robust_results is a list with:</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co"># [[1]]: variance-covariance matrix</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co"># [[2]]: coefficient test with robust SEs</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>robust_results[[<span class="dv">2</span>]]</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt;                     Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; (Intercept)        67.349587   1.149333 58.5988   &lt;2e-16 ***</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; treatmentTreatment  4.698475   0.452184 10.3906   &lt;2e-16 ***</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; baseline_score      0.036247   0.016691  2.1716     0.03 *  </span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Notice the standard errors are typically larger than classical SEs,
reflecting within-cluster correlation.</p>
</div>
<div id="incorporating-clusters-into-tidy_lm" class="section level3">
<h3>4.2 Incorporating clusters into <code>tidy_lm</code></h3>
<p>For multiple specifications with clustering, use <code>tidy_lm</code>
directly:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Run multiple specifications with clustering</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>clustered_models <span class="ot">&lt;-</span> <span class="fu">tidy_lm</span>(</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">data =</span> experiment_data,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">dv =</span> <span class="fu">c</span>(<span class="st">&quot;test_score&quot;</span>, <span class="st">&quot;attendance&quot;</span>),</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;baseline_score&quot;</span>, <span class="st">&quot;gender&quot;</span>),</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="at">clusters =</span> <span class="st">&quot;school_id&quot;</span>,</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="at">style =</span> <span class="st">&quot;incremental&quot;</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; Warning: Using `as.character()` on a quosure is deprecated as of rlang 0.3.0. Please use</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; `as_label()` or `as_name()` instead.</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co"># Extract treatment effects (now with cluster-robust SEs)</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>clustered_models <span class="sc">|&gt;</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>  <span class="fu">select</span>(dv, model_number, treatmentTreatment_coef, treatmentTreatment_se, treatmentTreatment_p)</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt;   dv         model_number treatmentTreatment_coef treatmentTreatment_se</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;             &lt;int&gt;                   &lt;dbl&gt;                 &lt;dbl&gt;</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; 1 test_score            1                  4.72                 0.462  </span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; 2 test_score            2                  4.70                 0.452  </span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; 3 test_score            3                  4.67                 0.454  </span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; 4 attendance            4                  0.0382               0.00409</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; 5 attendance            5                  0.0382               0.00405</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt; 6 attendance            6                  0.0382               0.00407</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt; # ℹ 1 more variable: treatmentTreatment_p &lt;dbl&gt;</span></span></code></pre></div>
</div>
</div>
<div id="preparing-tables-for-publication" class="section level2">
<h2>5 Preparing tables for publication</h2>
<div id="using-star_ready-with-stargazer" class="section level3">
<h3>5.1 Using <code>star_ready</code> with stargazer</h3>
<p>The <code>star_ready</code> function prepares <code>tidy_lm</code>
output for use with the <code>stargazer</code> package:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># First, run your models</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">tidy_lm</span>(</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">data =</span> experiment_data,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">&quot;test_score&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;baseline_score&quot;</span>),</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="at">style =</span> <span class="st">&quot;incremental&quot;</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co"># Prepare for stargazer</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>ready_for_table <span class="ot">&lt;-</span> <span class="fu">star_ready</span>(models, <span class="at">data =</span> experiment_data)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co"># Now use with stargazer (not run here to avoid LaTeX output)</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co"># library(stargazer)</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co"># stargazer(ready_for_table, type = &quot;latex&quot;)</span></span></code></pre></div>
</div>
<div id="table-formatting-utilities" class="section level3">
<h3>5.2 Table formatting utilities</h3>
<p>The package includes 14 utility functions for formatting LaTeX
tables. These functions work with LaTeX output captured via
<code>capture.output()</code> from packages like <code>stargazer</code>
or <code>knitr::kable()</code>.</p>
<div id="basic-number-and-text-formatting" class="section level4">
<h4>Basic number and text formatting</h4>
<p>Format numbers and add brackets/parentheses:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Format numbers consistently to 2 decimal places</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1543</span>, <span class="fl">2.567</span>, <span class="fl">10.2</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">two_digits</span>(values)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;0.15&quot;  &quot;2.57&quot;  &quot;10.20&quot;</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co"># Add parentheses (useful for standard errors in tables)</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="fu">add_parentheses</span>(<span class="fu">two_digits</span>(values))</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;(0.15)&quot;  &quot;(2.57)&quot;  &quot;(10.20)&quot;</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co"># Add brackets [useful for confidence intervals]</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="fu">add_brackets</span>(<span class="fu">two_digits</span>(values))</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;[0.15]&quot;  &quot;[2.57]&quot;  &quot;[10.20]&quot;</span></span></code></pre></div>
<p><strong>Other basic formatting functions:</strong> -
<code>word_italicize()</code>: Italicize specific words in LaTeX
output</p>
</div>
<div id="working-with-data-frames" class="section level4">
<h4>Working with data frames</h4>
<p>When preparing data for tables:</p>
<ul>
<li><code>add_top_row()</code>: Add a row to the top of a data
frame</li>
<li><code>add_bottom_row()</code>: Add a row to the bottom of a data
frame</li>
<li><code>nothing()</code>: Does nothing—useful as a placeholder at the
end of pipe chains</li>
</ul>
</div>
<div id="latex-table-structure-and-display" class="section level4">
<h4>LaTeX table structure and display</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Display LaTeX tables cleanly in R console</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>my_table <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">kable</span>(<span class="fu">head</span>(experiment_data), <span class="at">format =</span> <span class="st">&quot;latex&quot;</span>))</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">print_table</span>(my_table)  <span class="co"># Cleaner than cat()</span></span></code></pre></div>
<p><strong>Other structural functions:</strong> -
<code>table_label()</code>: Add LaTeX labels for cross-referencing
(e.g., <code>\ref{tab:results}</code>) - <code>table_numbers()</code>:
Customize table numbering (e.g., “Table 2a”, “Table 2b”) -
<code>kable_resize()</code>: Adjust table size in LaTeX documents</p>
</div>
<div id="stargazer-specific-formatting" class="section level4">
<h4>Stargazer-specific formatting</h4>
<p>Customize stargazer output after creating tables:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Capture stargazer output</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(test_score <span class="sc">~</span> treatment, <span class="at">data =</span> experiment_data)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>table_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">stargazer</span>(model, <span class="at">report =</span> <span class="st">&quot;csp&quot;</span>, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co"># Change p-value format from &quot;p = 0.05&quot; to [0.05]</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>table_with_brackets <span class="ot">&lt;-</span> <span class="fu">stargazer_pvalues</span>(table_output, <span class="st">&quot;brackets&quot;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="fu">print_table</span>(table_with_brackets)</span></code></pre></div>
<p><strong>Other stargazer functions:</strong> -
<code>add_endnote()</code>: Replace stargazer’s default notes with
custom footnotes - <code>stargazer_rowname()</code>: Customize row names
in stargazer tables</p>
</div>
</div>
<div id="typical-workflow-for-publication-ready-tables" class="section level3">
<h3>5.3 Typical workflow for publication-ready tables</h3>
<p>Most users will need only a few of these functions. A typical
workflow:</p>
<ol style="list-style-type: decimal">
<li><strong>Create your table</strong> with <code>stargazer()</code> or
<code>kable()</code> and capture output</li>
<li><strong>Format p-values</strong> if needed with
<code>stargazer_pvalues()</code></li>
<li><strong>Add footnotes</strong> with <code>add_endnote()</code></li>
<li><strong>Add labels</strong> with <code>table_label()</code> for
cross-referencing</li>
<li><strong>Preview</strong> with <code>print_table()</code> before
writing to file</li>
</ol>
<p>For complete documentation of all formatting functions, see
<code>?table_prep</code>.</p>
</div>
</div>
<div id="putting-it-all-together" class="section level2">
<h2>6 Putting it all together</h2>
<p>Here’s a complete workflow from analysis to publication-ready
table:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># 1. Run your regressions</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">tidy_lm</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="at">data =</span> experiment_data,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="at">dv =</span> <span class="fu">c</span>(<span class="st">&quot;test_score&quot;</span>, <span class="st">&quot;attendance&quot;</span>),</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;baseline_score&quot;</span>, <span class="st">&quot;gender&quot;</span>),</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="at">style =</span> <span class="st">&quot;incremental&quot;</span>,</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  <span class="at">clusters =</span> school_id</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co"># 2. Prepare for stargazer</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>table_ready <span class="ot">&lt;-</span> <span class="fu">star_ready</span>(models, <span class="at">data =</span> experiment_data)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co"># 3. Create table</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>raw_table <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>  <span class="fu">stargazer</span>(</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>    table_ready,</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>,</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Effect of growth mindset intervention on student outcomes&quot;</span>,</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>    <span class="at">dep.var.labels =</span> <span class="fu">c</span>(<span class="st">&quot;Test Score&quot;</span>, <span class="st">&quot;Attendance&quot;</span>),</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>    <span class="at">notes =</span> <span class="st">&quot;Placeholder note text&quot;</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>  )</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>)</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co"># 4. Format the table</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>formatted_table <span class="ot">&lt;-</span> raw_table <span class="sc">|&gt;</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>  <span class="fu">add_endnote</span>(</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>    <span class="at">note =</span> <span class="st">&quot;Standard errors clustered by school. All models control for baseline scores and gender.&quot;</span>,</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>    <span class="at">size_in_inches =</span> <span class="dv">6</span>,</span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>    <span class="at">rm.stargazer.stars =</span> <span class="cn">TRUE</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>  <span class="fu">table_label</span>(<span class="at">caption =</span> <span class="st">&quot;main_results&quot;</span>)</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co"># 5. Print for LaTeX document</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="fu">print_table</span>(formatted_table)</span></code></pre></div>
</div>
<div id="key-takeaways" class="section level2">
<h2>7 Key takeaways</h2>
<p><strong>For running regressions:</strong> - Use <code>tidy_lm</code>
when you need to run many specifications - Specify
<code>treatment</code> to extract coefficients you care about - Use
<code>clusters</code> for cluster-robust standard errors - Choose
<code>style</code> based on your needs (bivariate, incremental,
default)</p>
<p><strong>For creating tables:</strong> - <code>star_ready</code>
bridges <code>tidy_lm</code> output to <code>stargazer</code> - Table
formatting functions help polish LaTeX output - <code>print_table</code>
makes viewing LaTeX tables easier - Combine functions with pipes for
clean workflows</p>
<p><strong>Best practices:</strong> - Always cluster standard errors
when you have grouped data - Use consistent number formatting
(<code>two_digits</code>) across tables - Add descriptive notes and
labels for reproducibility - Test table formatting in your LaTeX
document early</p>
<p>For more examples, see the function documentation with
<code>?tidy_lm</code>, <code>?star_ready</code>, or
<code>?table_prep</code>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
